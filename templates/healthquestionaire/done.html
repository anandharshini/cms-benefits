{% extends "fullwidth.html" %}
{% load cms_tags %}
{% load i18n %}

{% block content %}
<script src="https://cdn.jsdelivr.net/npm/signature_pad@2.3.2/dist/signature_pad.min.js"></script>
<h1>Done submitting. Go back to Home Page <a href="{{PREFIX_URL}}?toolbar_off">Home</a></h1>

<div class="row">
    <div class="col s12 m6">
        <embed src="{{ signed_pdf_file }}" width="600" height="500" alt="pdf" pluginspage="http://www.adobe.com/products/acrobat/readstep2.html">
    </div>
    <div class="col s12 m6">
        <form id="signForm" method="POST" action="">
            {% csrf_token %}
            <div class="card blue-grey darken-1">
                {{ form.as_p }}
                <div class="card-content white-text">
                    <span class="card-title">Sign Below</span>
                    <canvas width="auto"></canvas>
                </div>
                <div class="card-action">
                    <button onclick="clearSignature()" class="btn">Clear</button>
                    <button onclick="submitSignature()" class="btn">Submit</button>
                </div>
            </div>                
        </form>
    </div>
</div>


<script>
    var canvas = document.querySelector("canvas");
    var signaturePad = new SignaturePad(canvas);

    function clearSignature(ev) {
        signaturePad.clear();
    }

    function submitSignature(ev) {
        const data = signaturePad.toDataURL();
        document.getElementsByName('sign_data')[0].value = data;
        //document.getElementById('signForm').submit();
    }
    
</script>
{% endblock %}